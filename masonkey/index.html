<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
  <title>The Key</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <style>
    span.title {
      font-weight: bolder;
    }
  </style>
</head>

<body>
  <nav class="red darken-1" role="navigation">
    <div class="nav-wrapper"><a id="logo-container" href="#" class="brand-logo">&nbsp;The Key</a>
  </nav>

  <div id="main" class="">
    <div class="section">
      <div class="row">
        <div class="col s12">
          <div class="card">
            <div class="card-content">
              <image src="thekey.jpg" />
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <span class="card-title">Enter your word here
              </span>
              <input placeholder="Enter the word" id="field1" />
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <span class="card-title">Result
              </span>
              <span id="result"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer>
    <p>Source: <a href="https://grahamhancock.com/leedsm1/">https://grahamhancock.com/leedsm1/</a> (<a
        href="https://archive.is/2og5Y">Archive</a>)</p>
  </footer>

  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>

</body>
<script>
  // generate letter values
  let value = 1;
  let letter_value = new Map();
  let countdown = false;
  for (var letter = 65; letter < 91; letter++) {
    if (value % 7 === 0) {
      countdown = !countdown;
    }
    var _char = String.fromCharCode(letter);
    value = (value === 0) ? 1 : value;
    letter_value.set(_char, value);
    if (countdown) {
      value--;
    } else {
      value++;
    }
  }
  console.log(letter_value);

  function forceKeyPressUppercase(e) {
    console.log("do it");
    var charInput = e.keyCode;
    let thewords = "";
    //thewords = document.getElementById("field1").value;
    if ((charInput >= 97) && (charInput <= 122)) { // lowercase
      if (!e.ctrlKey && !e.metaKey && !e.altKey) { // no modifier key
        var newChar = charInput - 32;
        var start = e.target.selectionStart;
        var end = e.target.selectionEnd;
        e.target.value = e.target.value.substring(0, start) + String.fromCharCode(newChar) + e.target.value.substring(end);
        e.target.setSelectionRange(start + 1, start + 1);
        e.preventDefault();
      }
    }
    thewords = document.getElementById("field1").value;

    if (thewords.length > 0) {
      //now do the calculation
      let result = "";
      console.log("the words...." + thewords);
      let mywords = thewords.split(" ");
      mywords.forEach(theword => {
        let myletters = theword.split("");
        let sum = 0;
        myletters.forEach(mychar => {
          let letter_val = letter_value.get(mychar);
          sum += letter_val;
        });
        console.log("total val is", sum);
        result = result + "<br/>" + "Total for <strong>" + theword + "</strong> is " + sum;
        document.getElementById("result").innerHTML = result;
      })
    } else {
      document.getElementById("result").innerHTML = "";
    }
  }

  document.getElementById("field1").addEventListener("keypress", forceKeyPressUppercase, false);

  document.getElementById("field1").addEventListener("keyup", forceKeyPressUppercase, false);
</script>

</html>